function getGlobal(){return globalThis||self||window||global}function isBrowser(){return"undefined"!=typeof window||"undefined"!=typeof self}function isNode(){return"undefined"!=typeof process&&process.versions&&process.versions.node&&"object"==typeof module}function isWorker(){return"undefined"!=typeof self&&getGlobal()===self||isNode()&&("undefined"!=typeof Worker||"undefined"!=typeof parentPort)}function ObjectForEach(e,t){let r=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n],r++,e)}function ObjectMap(e,t){const r={};let n=0;for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&(r[s]=t(s,e[s],n++,e));return r}function newUID(e=16){let t;if(isBrowser()||!isNode()&&isWorker())t=new Uint8Array(e),getGlobal().crypto.getRandomValues(t);else if(isNode()){const r=require("crypto");t=r.randomBytes(e)}return Array(e).fill(0).map(((e,r)=>function(e){const t=(e<0?-e:e)%62;return t<10?String.fromCharCode(48+t):t<36?String.fromCharCode(65+t-10):String.fromCharCode(97+t-36)}(t[r]))).join("")}function hasClass(e,t){if(e&&e instanceof Element&&t&&"string"==typeof t)return e.classList.contains(t);throw new Error("Element and/or ClassName arguments are not correct.")}function addClass(e,t,r){if(r=r||!1,e&&e instanceof Element&&t&&"string"==typeof t)return r?new Promise((function(r){window.requestAnimationFrame((function(){e.classList.add(t),r(e.classList)}))})):(e.classList.add(t),e.classList);throw new Error("Element and/or ClassName arguments are not correct.")}function removeClass(e,t,r){if(r=r||!1,e&&e instanceof Element&&t&&"string"==typeof t)return r?new Promise((function(r){window.requestAnimationFrame((function(){e.classList.remove(t),r(e.classList)}))})):(e.classList.remove(t),e.classList);throw new Error("Element and/or ClassName arguments are not correct.")}function toggleClass(e,t,r){if(r=r||!1,e&&e instanceof Element&&t&&"string"==typeof t)return hasClass(e,t)?removeClass(e,t,r):addClass(e,t,r);throw new Error("Element and/or ClassName arguments are not correct.")}function attr(e,t,r){return t&&"string"==typeof t?void 0!==r?e.setAttribute(t,r):e.getAttribute(t):e.attributes}function data(e,t,r){return t&&"string"==typeof t?void 0!==r?(e.dataset[t]=r,e.dataset[t]):e.dataset[t]:e.dataset}function ecs(...e){const{length:t}=e;if(e=e.filter((e=>!!e)),0===t)return document.createElement("div");if(1!==t){const r=document.createElement("div");for(let n=0;n<t;n+=1)r.appendChild(ecs(e[n]));return r}let r=e[0];if(r instanceof Element)return r;const{actions:n,attr:s,class:o,data:i,_:a,events:c,id:l,ns:u,style:h,t:d}=r;if(l||o||d?(r=u&&"string"==typeof u?document.createElementNS(u,d&&"string"==typeof d?d:"div"):document.createElement(d&&"string"==typeof d?d:"div"),l&&(r.id=l),o&&("string"==typeof o?r.classList.add(o):Array.isArray(o)&&r.classList.add(...o))):r=document.createElement("div"),s&&ObjectForEach(s,(function(e,t){t instanceof Promise?t.then((function(t){attr(r,e,t)})):attr(r,e,t)})),i&&ObjectForEach(i,(function(e,t){t instanceof Promise?t.then((function(t){r.dataset[e]=t})):r.dataset[e]=t})),c)for(const e of c)r.addEventListener(...e);if(h&&ObjectForEach(h,(function(e,t){t instanceof Promise&&t.then((function(t){r.style[e]=t})),r.style[e]=t})),a)for(const e of"string"!=typeof a&&Symbol.iterator in a?a:[a])if(e instanceof Element)r.appendChild(e);else if("string"==typeof e)r.innerHTML+=e;else if(e instanceof Promise){const t=document.createElement("template");r.appendChild(t),e.then((function(e){"string"==typeof e?(t.outerHTML+=e,t.remove()):r.replaceChild(ecs(e),t)})).catch((function(e){console.error("ecs error: ",e)}))}else["number","bigint","boolean","symbol"].includes(typeof e)?r.innerHTML+=`${e}`:r.appendChild(ecs(e));return n&&ObjectForEach(n,(function(e,t){const n=e.split(/\_\$/);n.length>1?r[n[0]](...t):r[e](...t)})),r}function ecsr(){const{currentScript:e}=document,{parentElement:t}=e;[document.head,document.documentElement].includes(t)||t.replaceChild(ecs(...arguments),e)}class IArray{static toImmutable(e){if(IArray.isIArray(e))return Object.freeze(e);if(Array.isArray(e)||Symbol.iterator in e&&void 0!==e.length&&void 0!==e[0])return Object.freeze(Object.setPrototypeOf(e,IArray.prototype));throw new TypeError("Please use IArray.from")}static from(...e){switch(e.length){case 0:throw new Error("What's the point of creating an Immutable 0-sized ?");case 1:{const t=[],r=e[0];if(r&&Symbol.iterator in r){const e=r[Symbol.iterator]();let n,s;for(;({value:n,done:s}=e.next()),!s;)t.push(n)}else if(r&&"object"==typeof r)for(const e in r)Object.prototype.hasOwnProperty.call(r,e)&&t.push(r[e]);return IArray.toImmutable(t)}default:return new IArray(...e)}}static isIArray(e){return Object.getPrototypeOf(e)===IArray.prototype&&"length"in e&&(!Object.isExtensible(e)||Object.isFrozen(e))}static[Symbol.hasInstance](e){return IArray.isIArray(e)}static isCollapsable(e){return IArray.isIArray(e)||Array.isArray(e)}static isResizable(e){return Object.isExtensible(e)}static isImmutable(e){return Object.isFrozen(e)}constructor(...e){const{length:t}=e;1===t&&"number"==typeof e[0]?this.length=e[0]:(this.length=t,Object.freeze(this))}[Symbol.iterator](){const{length:e}=this;let t=0;return{next:()=>({value:t<e?this[t]:void 0,done:!(t++<e)})}}deepLength(){const{length:e}=this;let t=e;for(let r=0;r<e;r+=1)IArray.isCollapsable(this[r])&&(t+=IArray.prototype.deepLength.call(this[r])-1);return t}initialize(){if(IArray.isImmutable(this))throw new Error("As an immutable data structure, <fill> method can not be called on it.");for(let e=0,{length:t}=this;e<t;e+=1)this[e]=null;return Object.preventExtensions(this)}fill(e,t,r){if(IArray.isImmutable(this))throw new Error("As an immutable data structure, <fill> method can not be called on it.");{const{length:n}=this,s=void 0!==r&&r>=0&&r<n?r>t?r:t:n;for(let o=void 0!==t&&t>=0&&t<n?t<r?t:r:0;o<s;o+=1)this[o]=e;return Object.freeze(this)}}populate(e){if(IArray.isImmutable(this))throw new Error("As an immutable data structure, <populate> method can not be called on it.");for(let t=0,{length:r}=this;t<r;t+=1)this[t]=e(t,this);return Object.freeze(this)}at(e){return e<0?this[this.length+e]:e}values(){return{[Symbol.iterator]:this[Symbol.iterator]}}entries(){return{[Symbol.iterator]:()=>{const{length:e}=this;let t=0;return{next:()=>({value:t<e?new IArray(t,this[t]):void 0,done:!(t++<e)})}}}}keys(){return{[Symbol.iterator]:()=>{const{length:e}=this;let t=0;return{next:()=>({value:t<e?t:void 0,done:!(t++<e)})}}}}forEach(e,t){t=t||this;for(let r=0,{length:n}=t;r<n;r+=1)e(t[r],r,t)}includes(e,t){for(let{length:r}=this,n=t>=0&&t<r?t:0;n<r;n+=1)if(Object.is(this[n],e))return!0;return!1}indexOf(e,t){for(let{length:r}=this,n=t>=0&&t<r?t:0;n<r;n+=1)if(Object.is(this[n],e))return n;return-1}lastIndexOf(e,t){for(let{length:r}=this,n=t>=0&&t<r?t:r;n>0;n-=1)if(Object.is(this[n],e))return n;return-1}map(e,t){return new IArray((t=t||this).length).populate((r=>e(t[r],r,t)))}reduce(e,t){let r=t||this[0];for(let t=0,{length:n}=this;t<n;t+=1)r=e(r,this[t],t,this);return r}reduceRight(e,t){const{length:r}=this;let n=t||this[r-1];for(let t=r;t>0;t-=1)n=e(n,this[t],t,this);return n}filter(e,t){t=t||this;const{length:r}=t,n=[];for(let s=0;s<r;s+=1)e(t[s],s,t)&&n.push(t[s]);return IArray.toImmutable(n)}every(e,t){t=t||this;for(let r=0,{length:n}=t;r<n;r+=1)if(!e(t[r],r,t))return!1;return!0}some(e,t){t=t||this;const{length:r}=t;for(let n=0;n<r;n+=1)if(e(t[n],n,t))return!0;return!1}find(e,t){t=t||this;const{length:r}=t;for(let n=0;n<r;n+=1)if(e(t[n],n,t))return t[n]}findIndex(e,t){t=t||this;const{length:r}=t;for(let n=0;n<r;n+=1)if(e(t[n],n,t))return n;return-1}reverse(){const{length:e}=this,t=new IArray(e);for(let r=1;r<=e;r-=1)t[r-1]=this[e-r];return Object.freeze(t)}slice(e,t){const{length:r}=this,n=e>=0&&e<r?e:0,s=t>=0&&t<=r?t:r,o=new IArray(s-n);let i=0;for(let e=n;e<s;e+=1)o[i++]=this[e];return Object.freeze(o)}splice(e,t,...r){const{length:n}=this,{length:s}=r;let o=void 0===t?n-e:t>=0?t:0;const i=n-o+s;console.log(i);const a=new IArray(i);let c=0;for(let t=0;t<n;t+=1)if(t===e){if(s)for(let e=0;e<s;e+=1)a[c++]=r[e],(o-=1)>0&&(t+=1)}else if(t>e){for(;(o-=1)>0&&t<n;)t+=1;t<n&&(a[c++]=this[t])}else a[c++]=this[t];return Object.freeze(a)}flatMap(e,t){t=t||this;const{length:r}=t,n=[];for(let s=0;s<r;s+=1){const r=e(t[s],s,t);if(IArray.isCollapsable(r))for(let e=0,{length:t}=r;s<t;s+=1)void 0!==r[e]&&n.push(r[_j]);else void 0!==r&&n.push(r)}return IArray.toImmutable(n)}flat(e){const t=[];for(let r=0,{length:n}=this;r<n;r+=1)if(e>1&&IArray.isCollapsable(this[r])){const n=this[r].flat(e-1);for(let e=0,{length:r}=n;e<r;e+=1)t.push(n[e])}else t.push(this[r]);return IArray.toImmutable(t)}concat(...e){const t=[];for(let e=0,{length:r}=this;e<r;e+=1)t.push(this[e]);for(let r=0,{length:n}=e;r<n;r+=1)if(IArray.isCollapsable(e[r]))for(let n=0,{length:s}=e[r];n<s;n+=1)t.push(e[n]);else t.push(e[r]);return IArray.toImmutable(t)}copyWithin(e,t,r){const{length:n}=this,s=new IArray(n);if(e>n){for(let e=0;e<n;e+=1)s[e]=this[e];return IArray.toImmutable(s)}const o=void 0===t?0:t<0?n+t:t>n?n:t,i=void 0===r?n:r<0?n+r:r>n?n:r;let a=0,[c,l]=o<i?[i-o,o]:[o-i,i];for(let t=0;t<n;t+=1)t>=e&&c-- >0?s[a]=this[l++]:s[a]=this[t],a+=1;return IArray.toImmutable(s)}join(e){const{length:t}=this;let r="";for(let n=0;n<t;n+=1)r=`${r}${e}${this[n]}`;return r}sort(e){e=e||((e,t)=>e<t?-1:e>t?1:0);const{length:t}=this;if(t<=1)return IArray.from(this);const r=Math.floor(t/2),n=this.slice(0,r),s=this.slice(r);return function(t,r){const{length:n}=t,{length:s}=r,o=new IArray(n+s);let i=0,a=0,c=0;for(;a<n&&c<s;)e(t[a],r[c])<0?o[i++]=t[a++]:o[i++]=r[c++];for(let e=a;e<n;e+=1)o[i++]=t[e];for(let e=c;e<s;e+=1)o[i++]=r[e];return IArray.toImmutable(o)}(n.sort(e),s.sort(e))}reshape(...e){const{length:t}=e;if(0===t)return this.flat(1/0);let r=this.flat(1/0),{length:n}=r;if(t>=1&&(n%e.reduce(((e,t)=>e*t))!=0||n%e[0]!=0))throw new RangeError(`An array of shape (${n}, 1)  can not be converted to an array of shape (${e.join(",")})`);for(let n=t-1;n>=0;n-=1){const t=e[n],s=r.length/t;r=new IArray(s).populate((e=>new IArray(t).populate((n=>r[e*t+n]))))}return r}push(...e){const{length:t}=this,{length:r}=e;if(IArray.isImmutable(this)){const n=new IArray(sum);for(let e=0;e<t;e+=1)n[e]=this[e];for(let s=0;s<r;s+=1)n[s+t]=e[s];return Object.freeze(n)}if(IArray.isResizable(this)){for(let n=0;n<r;n+=1)this[t+n]=e[n];return this.length=sum,this}throw new Error("What the fuck are you doing ?")}empty(){if(IArray.isImmutable(this))throw new TypeError("As an immutable data structure, <empty> method can not be called on it.");for(let e=0,{length:t}=this;e<t;e+=1)this[e]=null;return this}}class Wait{constructor(){}static register(){const e=getGlobal();return void 0===e.WaitRegister&&(e.WaitRegister={interactive:[],complete:[],DOMContentLoaded:[],load:[]},document.addEventListener("readystatechange",(()=>Wait.all(document.readyState))),document.addEventListener("DOMContentLoaded",(()=>Wait.all("DOMContentLoaded"))),window.addEventListener("load",(()=>Wait.all("load")))),e.WaitRegister}static set(e,t){const{resolve:r,reject:n,func:s,args:o}=t,i=Wait.register();let a=!1;const{readyState:c}=document;switch(e){case"interactive":case"DOMContentLoaded":if("loading"!==c){a=!0;try{r(s(...o))}catch(e){n(e)}}break;case"complete":case"load":if("complete"===c){a=!0;try{r(s(...o))}catch(e){n(e)}}}!1===a&&i[e].push((function(){return new Promise((function(e,t){try{return e(r(s(...o)))}catch(e){t(n(e))}}))}))}static all(e){return Promise.all(Wait.register()[e].map((e=>e())))}static time(e){return new Promise((t=>setTimeout(t,e)))}static delay(e,t,...r){return setTimeout(e,t||0,...r)}static async(e,...t){return new Promise((function(r,n){try{r(e(...t))}catch(e){n(e)}}))}static promiseDelay(e,t,...r){return new Promise((function(n,s){return setTimeout((function(...t){try{return n(e(...t))}catch(e){return s(e)}}),t,...r)}))}static interactive(e,...t){return new Promise((function(r,n){Wait.set("interactive",{resolve:r,reject:n,func:e,args:t})}))}static complete(e,...t){return new Promise((function(r,n){Wait.set("complete",{resolve:r,reject:n,func:e,args:t})}))}static DOMContentLoaded(e,...t){return new Promise((function(r,n){Wait.set("DOMContentLoaded",{resolve:r,reject:n,func:e,args:t})}))}static ready(e,...t){return new Promise((function(r,n){Wait.set("complete",{resolve:r,reject:n,func:e,args:t})}))}static load(e,...t){return new Promise((function(r,n){Wait.set("complete",{resolve:r,reject:n,func:e,args:t})}))}}class ImageLoader{constructor(){this.worker=new ExtendedWorker((function(){self.onmessage=function(e){(function(e,t,r){return r=r&&"object"==typeof r?r:Object.create(null),new Promise((async function(n,s){fetch(e,{method:"GET",mode:"cors",credentials:"include",cache:"default",...r}).then((async function(e){if(200===e.status)try{const r=await e.blob();return n([t,URL.createObjectURL(r)])}catch(e){return console.error(e),s([t,""])}return console.error(e),s([t,""])})).catch((function(e){return console.error(e),s([t,""])}))}))})(e.data.data.url,e.data.id).then((function([e,t]){self.postMessage({id:e,data:{url:t||""}})}))}}),{promise:!0})}async load(e={}){const{src:t,webp:r}=e;let n;if(r&&"string"==typeof r){n=await WebPTest.passed?(await this.worker.postMessage({url:r})).url:(await this.worker.postMessage({url:t})).url}else n=(await this.worker.postMessage({url:t})).url;return n}static async load(e){const t=getGlobal();return"ImageLoader"in t||(t.ImageLoader=new ImageLoader),await t.ImageLoader.load(e)}terminate(){this.worker.terminate()}static terminate(){const e=getGlobal();"ImageLoader"in e&&(e.ImageLoader.terminate(),delete e.ImageLoader)}}const Easing={linearTween:function(e,t,r,n){return r*e/n+t},easeInQuad:function(e,t,r,n){return r*(e/=n)*e+t},easeOutQuad:function(e,t,r,n){return-r*(e/=n)*(e-2)+t},easeInOutQuad:function(e,t,r,n){return(e/=n/2)<1?r/2*e*e+t:-r/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,r,n){return r*(e/=n)*e*e+t},easeOutCubic:function(e,t,r,n){return e/=n,r*(--e*e*e+1)+t},easeInOutCubic:function(e,t,r,n){return(e/=n/2)<1?r/2*e*e*e+t:r/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,r,n){return r*(e/=n)*e*e*e+t},easeOutQuart:function(e,t,r,n){return e/=n,-r*(--e*e*e*e-1)+t},easeInOutQuart:function(e,t,r,n){return(e/=n/2)<1?r/2*e*e*e*e+t:-r/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,r,n){return r*(e/=n)*e*e*e*e+t},easeOutQuint:function(e,t,r,n){return e/=n,r*(--e*e*e*e*e+1)+t},easeInOutQuint:function(e,t,r,n){return(e/=n/2)<1?r/2*e*e*e*e*e+t:r/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,r,n){return-r*Math.cos(e/n*(Math.PI/2))+r+t},easeOutSine:function(e,t,r,n){return r*Math.sin(e/n*(Math.PI/2))+t},easeInOutSine:function(e,t,r,n){return-r/2*(Math.cos(Math.PI*e/n)-1)+t},easeInExpo:function(e,t,r,n){return r*Math.pow(2,10*(e/n-1))+t},easeOutExpo:function(e,t,r,n){return r*(1-Math.pow(2,-10*e/n))+t},easeInOutExpo:function(e,t,r,n){return(e/=n/2)<1?r/2*Math.pow(2,10*(e-1))+t:(e--,r/2*(2-Math.pow(2,-10*e))+t)},easeInCirc:function(e,t,r,n){return e/=n,-r*(Math.sqrt(1-e*e)-1)+t},easeOutCirc:function(e,t,r,n){return e/=n,e--,r*Math.sqrt(1-e*e)+t},easeInOutCirc:function(e,t,r,n){return(e/=n/2)<1?-r/2*(Math.sqrt(1-e*e)-1)+t:(e-=2,r/2*(Math.sqrt(1-e*e)+1)+t)}};function smoothScrollTo(e,t,r=1e3){e.preventDefault(),e.stopPropagation();const{easeInOutCubic:n}=Easing,s=document.querySelector(t);if(!(s instanceof HTMLElement))return;const o=window.pageYOffset,i=o+s.getBoundingClientRect().top-o;let a=0;window.requestAnimationFrame((function e(t){a=a||t;const s=t-a,c=n(s,o,i,r);window.scrollTo(0,c),s<r&&window.requestAnimationFrame(e)}))}const Cookies={expires:function(){const e=new Date;return e.setTime(e.getTime()+31557081599.999996),e.toGMTString()},get:function(e){return new Map(decodeURIComponent(document.cookie).split(/;/).map((e=>e.trim().split(/=/)))).get(e)},has:function(e){return new Map(decodeURIComponent(document.cookie).split(/;/).map((e=>e.trim().split(/=/)))).has(e)},set:function(e,t,r={}){let{expiration:n,sameSite:s,path:o}=r;const i=[`${e}=${encodeURIComponent(t)}`];i.push(`expires=${n||this.expires()}`),i.push(`path=${o||"/"}`),i.push(`SameSite=${s||"None"};Secure`),document.cookie=i.join(";")},delete:function(e){document.cookie=`${e}=;expires=0;`}};class WebPTest{constructor(){}static get data(){return[["lossy","UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA"],["lossless","UklGRhoAAABXRUJQVlA4TA0AAAAvAAAAEAcQERGIiP4HAA=="],["alpha","UklGRkoAAABXRUJQVlA4WAoAAAAQAAAAAAAAAAAAQUxQSAwAAAARBxAR/Q9ERP8DAABWUDggGAAAABQBAJ0BKgEAAQAAAP4AAA3AAP7mtQAAAA=="],["animation","UklGRlIAAABXRUJQVlA4WAoAAAASAAAAAAAAAAAAQU5JTQYAAAD/////AABBTk1GJgAAAAAAAAAAAAAAAAAAAGQAAABWUDhMDQAAAC8AAAAQBxAREYiI/gcA"]]}static save(e){const t=getGlobal();return t.WebPTestResult=e.reduce((function(e,[t,r]){if(!(t in e))return e[t]=r,e}),Object.create(null)),t.WebPTestResult}static imageLoading(e,t){return new Promise((function(r){const n=new Image;n.onload=function(){r([t,n.width>0&&n.height>0])},n.onerror=function(){r([t,!1])},n.src=e}))}static test(){const e=getGlobal();return new Promise((function(t){"WebPTestResult"in e?t(e.WebPTestResult):Promise.all(WebPTest.data.map((function([e,t]){return WebPTest.imageLoading(`data:image/webp;base64,${t}`,e)}))).then((function(e){t(WebPTest.save(e))}))}))}static get passed(){const e=getGlobal();let t;return new Promise((async function(r){t="WebPTestResult"in e?e.WebPTestResult:await WebPTest.test(),r(t.lossy&&t.lossless&&t.alpha&&t.animation)}))}}class Benchmark{constructor(e={}){isBrowser()?this.perf=getGlobal().performance:isNode()&&({performance:this.perf}=require("perf_hooks")),this.options={_logging:e.logging||!1,_iterations:void 0,_last:void 0},this.match={},this.metrics=new Map,this.pool=new Map,this.testPool=new Map,this.ticks=[]}get uid(){return newUID(10)}set last(e){return this.options._last=e}get last(){return this.options._last}get logging(){return this.options._logging}get iterations(){return this.options._iterations}set iterations(e){this.options._iterations=e}add(e,t,...r){const{uid:n}=this;return this.last=n,this.match[n]=e,this.pool.set(n,(()=>{let s,o,i=0,a=0,c=this.testPool.get(n);if(c)do{o=this.perf.now();const n=t(...r);if(i+=this.perf.now()-o,!c(n))throw console.group(`Test Failed - ${e}`),console.error("Test Function",c),console.error("Tested Result",n),console.groupEnd(`Test Failed - ${e}`),new Error("Test failed.")}while(a++,i<5e3);else{o=this.perf.now();do{t(...r)}while(a++,(s=this.perf.now())<o+5e3);i=s-o}const l=a/(i/1e3),u={ops:l,elapsed:i,iterations:a};return console.log(`Func ${e}\n\t> ${l.toFixed(3)} op/s\n\t> ${a} op`),this.metrics.set(n,u),u})),this}test(e){const{last:t}=this;return this.testPool.set(t,e),this.last=void 0,this}start(){const e=this.perf.now();this.logging&&console.warn(`Started ${e} ms after page load.`),this.ticks.push(e)}tick(){const e=this.perf.now(),t=e-this.ticks[this.ticks.length-1];return this.logging&&console.log(`Lap : ${t} ms`),this.ticks.push(e),t}stop(){const e=this.perf.now(),t=e-this.ticks[this.ticks.length-1],r=e-this.ticks[0];return this.logging&&(t!==r&&console.log(`Lap : ${t} ms`),console.log(`Total : ${r} ms`),console.warn(`Ended ${e} ms after page load.`)),this.ticks.push(e),r}run(){const e=[...this.pool.keys()],t=[...this.pool.values()];console.group("Execution");const r=t.map((e=>e()));console.groupEnd();const n=r.map((({ops:t},r)=>[e[r],t])).sort((([e,t],[r,n])=>n-t));return console.group("Results"),n.forEach((([e,t],r)=>{console.log(`#${r+1} -- Func ${this.match[e]}\n\t> ${t.toFixed(3)} op/s`)})),console.groupEnd(),this}}class ExtendedWorker{constructor(e,t){"function"==typeof e&&(e=ExtendedWorker.prepareFromFunction(e,t)),this.worker=new Worker(e,t),t&&"promise"in t&&!0===t.promise?(this.worker.promise=!0,ExtendedWorker.assert(),this.worker.onmessage=ExtendedWorker.onMessage):this.worker.promise=!1}static prepareFromString(e,t){const r=[];if("object"==typeof t&&("localImports"in t&&("string"==typeof t.localImports?r.push(`${window.location.origin}${t.localImports}`):r.push(...t.localImports.map((e=>`${window.location.origin}${e}`)))),"importScripts"in t&&("string"==typeof t.importScripts?r.push(t.importScripts):r.push(...t.importScripts))),"string"==typeof e){const t=`${r.length>0?`importScripts('${r.join("','")}');\n`:""}(${e})();`,n=new Blob([t],{type:"text/javascript"});return URL.createObjectURL(n)}throw new Error(`WorkerString:${e} is not a string.`)}static prepareFromFunction(e,t){if("function"==typeof e)return ExtendedWorker.prepareFromString(e.toString(),t);throw new Error(`WorkerFunction:${e} is not a function.`)}static createFromString(e,t){const r=[];if("object"==typeof t&&("localImports"in t&&("string"==typeof t.localImports?r.push(`${window.location.origin}${t.localImports}`):r.push(...t.localImports.map((e=>`${window.location.origin}${e}`)))),"importScripts"in t&&("string"==typeof t.importScripts?r.push(t.importScripts):r.push(...t.importScripts))),"string"==typeof e){const n=`${r.length>0?`importScripts('${r.join("','")}');\n`:""}(${e})();`,s=new Blob([n],{type:"text/javascript"});return new ExtendedWorker(URL.createObjectURL(s),t)}throw new Error(`WorkerString:${e} is not a string.`)}static createFromFunction(e,t){if("function"==typeof e)return ExtendedWorker.createFromString(e.toString(),t);throw new Error(`WorkerFunction:${e} is not a function.`)}set onmessage(e){this.worker.onmessage=e}get onmessage(){return this.worker.onmessage}set onerror(e){this.worker.onerror=e}get onerror(){return this.worker.onerror}set onmessageerror(e){this.worker.onmessageerror=e}get onmessageerror(){return this.worker.onmessageerror}dispatchEvent(e){return this.worker.dispatchEvent(e)}addEventListener(e,t,r){return this.worker.addEventListener(e,t,r)}removeEventListener(e,t,r){this.worker.removeEventListener(e,t,r)}terminate(){this.worker.terminate()}postMessage(e,t){return ExtendedWorker.postMessage([e,t],this.worker)}static assert(){const e=getGlobal();return"ExtendedWorkers"in e?"resolves"in e.ExtendedWorkers&&"rejects"in e.ExtendedWorkers||(e.ExtendedWorkers.resolves={},e.ExtendedWorkers.rejects={}):e.ExtendedWorkers={resolves:{},rejects:{}},e.ExtendedWorkers}static postMessage(e,t){if(t.promise){const r=newUID(),[n,s]=e,o={id:r,data:n};return new Promise((function(e,n){ExtendedWorker.resolves[r]=e,ExtendedWorker.rejects[r]=n,s?t.postMessage(o,s):t.postMessage(o)}))}t.postMessage(...e)}static onMessage(e){const{id:t,err:r,data:n}=e.data,s=ExtendedWorker.resolves[t],o=ExtendedWorker.rejects[t];n?s&&s(n):o&&r&&o(r),ExtendedWorker.delete(t)}static get resolves(){return ExtendedWorker.assert().resolves}static get rejects(){return ExtendedWorker.assert().rejects}static delete(e){delete ExtendedWorker.resolves[e],delete ExtendedWorker.rejects[e]}}class DatasetEncoder{constructor(){this.values=[]}getEncoded(e){const t=this.values.indexOf(e);return t>-1?t:(this.length=this.values.push(e),this.length-1)}getDecoded(e){if(this.length<=e)throw new Error;return this.values[e]}getOneHotEncoded(e){const t=this.values.indexOf(e);if(t>-1){const e=Array(this.values.length).fill(0);return e[t]=1,e}throw new Error}getOneHotEncodedByIndex(e){const{length:t}=this.values;if(e>=t||e<0)throw new Error;{const r=Array(t).fill(0);return r[e]=1,r}}}class DatasetHeader{constructor(e,t){this.keys=new Map,this.types=new Map,this.indexes=new Map,this.encoders=new Map,this.nextIndex=0,e&&this.parseFromArray(e,t)}get columns(){return[...this.indexes.keys()]}getColumnByKey(e){return this.indexes.has(e)?{key:e,index:this.indexes.get(e),...this.types.has(e)?{type:this.types.get(e)}:{},...this.encoders.has(e)?{encoder:this.encoders.get(e)}:{}}:void 0}getColumnByIndex(e){if(this.keys.has(e)){const t=this.keys.get(e);return{key:t,index:e,...this.types.has(t)?{type:this.types.get(t)}:{},...this.encoders.has(t)?{encoder:this.encoders.get(t)}:{}}}}getColumnKeyByColumnIndex(e){return this.keys.get(e)}getColumnIndexByColumnKey(e){return this.indexes.get(e)}registerColumnEncoderByColumnKey(e){const t=new DatasetEncoder(e);return this.encoders.set(e,t),t}getColumnEncoderByColumnKey(e){return this.encoders.get(e)}registerColumnEncoderByColumnIndex(e){const t=this.keys.get(e),r=new DatasetEncoder(t);return this.encoders.set(t,r),r}getColumnEncoderByColumnIndex(e){return this.encoders.get(this.keys.get(e))}getColumnTypeByColumnKey(e){return this.types.get(e)}setColumnTypeByColumnKey(e,t){this.types.set(e,Dataset.parseType(t))}getColumnTypeByColumnIndex(e){return this.types.get(this.keys.get(e))}setColumnTypeByColumnIndex(e,t){this.types.set(this.keys.get(e),Dataset.parseType(t))}hasColumn(e){return this.indexes.has(e)}doesIndexExist(e){return this.keys.has(e)}addColumn(e,t,r=!1){const n=this.nextIndex++;this.keys.set(n,e),this.indexes.set(e,n),this.types.set(e,Dataset.parseType(t)),r&&this.encoders.set(e,new DatasetEncoder(e))}removeColumns(e){const t=Array.isArray(e)?e:[e],r=[];for(const e of t){this.types.delete(e),this.encoders.delete(e);const t=this.indexes.get(e);this.keys.delete(t),this.indexes.delete(e),r.push(t)}const n=new Map,s=new Map;let o=0;for(const e of this.indexes.keys())n.set(e,o),s.set(o,e),o+=1;return this.indexes=n,this.keys=s,this.nextIndex=o,r}parseFromArray(e,t={}){const{types:r={},encoders:n=[]}=t;for(const t of e)this.addColumn(t,r[t],n.includes(t));this.nextIndex=e.length}static parseFromArray(e,t={}){const{types:r={},encoders:n=[]}=t,s=new DatasetHeader;for(const t of e)s.addColumn(t,r[t],n.includes(t));return s.nextIndex=e.length,s}}class Dataset{static log(e,t=!0){if(console.log(`\n<-- ${e.length} ROWS --\x3e`),t)if(e.length>10){const t=e.slice(0,5),r=e.slice(-5);for(const e of t)Array.isArray(e[0])?console.log("[ ",e.map((e=>Array.isArray(e)?`\n  [ ${e.join(", ")} ]`:e)).join(", "),"\n]"):console.log("[ ",e.join(", ")," ]");for(let e=0;e<3;e+=1)console.log("...");for(const e of r)Array.isArray(e[0])?console.log("[ ",e.map((e=>Array.isArray(e)?`\n  [ ${e.join(", ")} ]`:e)).join(", "),"\n]"):console.log("[ ",e.join(", ")," ]")}else for(const t of e)Array.isArray(t[0])?console.log("[ ",t.map((e=>Array.isArray(e)?`\n  [ ${e.join(", ")} ]`:e)).join(", "),"\n]"):console.log("[ ",t.join(", ")," ]");else{const t=e.slice(0,5),r=e.slice(-5);for(const e of t)console.log(e);for(let e=0;e<3;e+=1)console.log("...");for(const e of r)console.log(e)}console.log(`<-- ${e.length} ROWS --\x3e\n`)}static _getLines(e){return e.split(/\n/g)}static _getCells(e){return e.map((e=>e.replace(/\r/g,"").split(/,/g).map((e=>e.trim()))))}static _getNotEmptyLines(e){return e.filter((e=>e.length>0&&e.some((e=>!0==!!e))))}static readFile(e){let t;if("string"!=typeof e)if(e instanceof ArrayBuffer){t=new TextDecoder("utf-8").decode(e)}else"undefined"!=typeof Buffer&&e instanceof Buffer&&(t=e.toString("utf-8"));return Dataset._getNotEmptyLines(Dataset._getCells(Dataset._getLines(t||e)))}static _flat(e,t,r={}){const{sortFunctionMap:n,filterFunctionMap:s,groupByFilterFunctionMap:o}=r,[i,...a]=e;if(void 0!==i){let e=t;if(e instanceof Map){if(e=[...t.keys()],n&&n.has(i)){let t;(t=n.get(i))&&(e=e.sort(t))}if(e=e.map((e=>Dataset._flat(a,t.get(e),{sortFunctionMap:n,filterFunctionMap:s,groupByFilterFunctionMap:o}))),o&&o.has(i)){let t;(t=o.get(i))&&(e=e.filter(t))}if(e=e.flat(1),s&&s.has(i)){let t;(t=s.get(i))&&(e=e.filter(t))}return e}if(Array.isArray(e)){if(s&&s.has(i)){let t;(t=s.get(i))&&(e=e.filter(t))}if(n&&n.has(i)){let t;(t=n.get(i))&&(e=e.sort(((e,r)=>t(e[i],r[i]))))}return e}return t}return t}static _groupBy(e,t){const[r,...n]=t;if(void 0!==r&&r>=0){const t=e.reduce((function(e,t){const n=t[r],s=e.has(n)?e.get(n):[];return s.push(t),e.set(n,s)}),new Map);if(n.length>0)for(const[e,r]of t.entries())t.set(e,Dataset._groupBy(r,n));return t}return e}static parseType(e){function t(e){return""===e?void 0:e}if("function"==typeof e)return function(t){return e(t)};switch(e){case"number":return function(e){const r=t(e);return void 0===r||isNaN(+r)?NaN:+r};case"bigint":return function(e){return BigInt(t(e))};case"boolean":return function(e){const r=t(e);return isNaN(+r)?Boolean(r):!!+r};case"object":return function(e){return JSON.parse(t(e))};case"string":return function(e){return String(t(e))};default:return t}}static parseHeader(e,t){return new DatasetHeader(e,t)}static load(e,t,r){return isBrowser()?new Promise(((n,s)=>{fetch(e,r).then((e=>{200===e.status&&e.ok?e.text().then((e=>n(new Dataset(e,t)))).catch(s):s(e)})).catch(s)})):isNode()?new Promise(((r,n)=>{require("fs").readFile(e,{encoding:"utf-8",flag:"r"},((e,s)=>{e?n(e):r(new Dataset(s,t))}))})):void 0}static loadExternal(e,t){if(isBrowser())return Dataset.load(e,t);if(isNode()){const r=require("https");require("fs");return new Promise(((n,s)=>{r.get(e,(e=>{e.setEncoding("utf-8");let r="";e.on("data",(e=>r+=e)),e.on("end",(()=>n(new Dataset(r,t)))),e.on("error",(e=>s(e)))}))}))}}constructor(e,t={}){const{excluded:r,encoders:n,types:s,slice:{start:o,end:i}={}}=t,[a,...c]=Dataset.readFile(e);this.header=Dataset.parseHeader(a,{types:s,encoders:n}),this.rows=this.parseRows(o||i?c.slice(o||0,i):c,{excluded:r})}get columns(){return this.header.columns}setType(e,t){this.header.setColumnTypeByColumnKey(e,t);const{index:r,type:n}=this.header.getColumnByKey(e);this.rows.forEach((e=>{e[r]=n(e[r])}))}setTypes(e){for(const[t,r]of e)this.setType(t,r)}getColumn(e){if(this.header.hasColumn(e)){const t=this.header.getColumnIndexByColumnKey(e);return this.rows.map((e=>e[t]))}throw new Error}removeColumns(e){Array.isArray(e);const t=this.header.removeColumns(e);return new Promise((e=>{this.mapAsync((e=>e.filter(((e,r)=>!t.includes(r))))).then((()=>e(!0)))}))}parseRows(e,t={}){const{excluded:r}=t,n=[];return r&&n.push(...this.header.removeColumns(r)),e.map((e=>e.filter(((e,t)=>!n.includes(t))).map(((e,t)=>{const{encoder:r,type:n}=this.header.getColumnByIndex(t);return r?r.getEncoded(n(e)):n(e)}))))}encodeColumn(e){const t=this.header.getColumnByKey(e),{index:r,type:n}=t;let{encoder:s}=t;s||(s=this.header.registerColumnEncoderByColumnKey(e));for(const e of this.rows)e[r]=s.getEncoded(n(e[r]));return this.rows}encodeColumns(e){const t=[];for(const r of e){const e=this.header.getColumnByKey(r),{index:n,type:s}=e;let{encoder:o}=e;o||(o=this.header.registerColumnEncoderByColumnKey(r)),o&&n&&t.push([n,s,o])}for(const[e,r,n]of t)for(const t of this.rows)t[e]=n.getEncoded(r(t[e]));return this.rows}encodeCell(e,t){const{type:r,encoder:n}=this.header.getColumnByKey(e);if(n)return n.getEncoded(r(t))}encodeCells(e,t){const{type:r,encoder:n}=this.header.getColumnByKey(e);if(n)return t.map((e=>n.getEncoded(r(e))))}decodeColumn(e){const{index:t,encoder:r}=this.header.getColumnByKey(e);for(const e of this.rows)e[t]=r.getDecoded(e[t]);return this.rows}decodeColumns(e){const t=[];for(const r of e){const{index:e,encoder:n}=this.header.getColumnByKey(r);n&&t.push([e,n])}for(const[e,r]of t)for(const t of this.rows)t[e]=r.getDecoded(t[e]);return this.rows}decodeCell(e,t){const r=this.header.getColumnEncoderByColumnKey(e);if(r)return r.getDecoded(t)}decodeCells(e,t){const r=this.header.getColumnEncoderByColumnKey(e);if(r)return t.map((e=>r.getDecoded(e)))}count(e,t){const r=Array.isArray(t)?t:[t],n=Object.create(null),s=Object.create(null);return r.forEach((e=>n[e]=this.header.getColumnIndexByColumnKey(e))),r.forEach((e=>s[e]=[])),this.forEach(((t,r)=>{for(const o in n)Object.is(t[n[o]],e)&&s[o].push(r)})),s[Symbol("target")]=e,s}async countAsync(e,t){const r=Array.isArray(t)?t:[t],n=Object.create(null),s=Object.create(null);return r.forEach((e=>n[e]=this.header.getColumnIndexByColumnKey(e))),r.forEach((e=>s[e]=[])),new Promise((t=>{this.forEachAsync(((t,r)=>{for(const o in n)Object.is(t[n[o]],e)&&s[o].push(r)})).then((()=>{s[Symbol("target")]=e,t(s)}))}))}groupBy(e){return Dataset._groupBy(this.rows,e.some((e=>"string"==typeof e))?e.map((e=>this.header.getColumnIndexByColumnKey(e))):e)}sortBy(e,t=!0){function r(e){if("function"==typeof e)return e;switch(`${e}`.toLowerCase()){case"d":case"desc":case"descending":case"za":case"z-a":return(e,t)=>t-e;default:return(e,t)=>e-t}}let n,s;if("string"==typeof e&&(e=[e]),e.some((e=>"string"==typeof e))&&(e=e.map((e=>"string"==typeof e?[this.header.getColumnIndexByColumnKey(e)]:[e]))),[n,s]=(e.some((([e])=>"string"==typeof e))?e.map((([e,t])=>[this.header.getColumnIndexByColumnKey(e),r(t)])):e.map((([e,t])=>[e,r(t)]))).reduce(((e,t,r)=>(e[0][r]=t[0],e[1].set(t[0],t[1]),e)),[[],new Map]),e.length>1){const e=Dataset._groupBy(this.rows,n),r=Dataset._flat(n,e,{sortFunctionMap:s});return t?(this.rows=r,this.rows):r}{const[e]=n;if(s.has(e)){let r;if(r=s.get(e))return t?this.rows.sort(((t,n)=>r(t[e],n[e]))):[...this.rows].sort(((t,n)=>r(t[e],n[e])))}}return this.rows}filter(e,t,r=!0){if("function"==typeof e)return this.rows=this.rows.filter(e);let n,s,o;if([n,s]=(e.some((([e])=>"string"==typeof e))?e.map((([e,t])=>[this.header.getColumnIndexByColumnKey(e),t])):e.map((([e,t])=>[e,t]))).reduce(((e,[t,r],n)=>(e[0][n]=t,e[1].set(t,r),e)),[[],new Map]),t&&(o=(t.some((([e])=>"string"==typeof e))?t.map((([e,t])=>[this.header.getColumnIndexByColumnKey(e),t])):t.map((([e,t])=>[e,t]))).reduce(((e,[t,r])=>e.set(t,r)),new Map)),e.length>1){const e=Dataset._groupBy(this.rows,n),t=Dataset._flat(n,e,{filterFunctionMap:s,groupByFilterFunctionMap:o});return r?(this.rows=t,this.rows):t}{const[e]=n;if(s.has(e)){const t=s.get(e);if(t){const e=this.rows.filter(t);return r?(this.rows=e,this.rows):e}}return this.rows}}forEach(e,t=this.rows){for(let r=0,n=this.rows.length;r<n;r+=1)e(this.rows[r],r,t)}async forEachAsync(e,t=this.rows){for(let r=0,n=this.rows.length;r<n;r+=1)e(this.rows[r],r,t)}map(e,t={}){const{inplace:r,thisArg:n=this.rows}=t;if(r){for(let t=0,r=this.rows.length;t<r;t+=1)this.rows[t]=e(this.rows[t],t,n);return this.rows}{const t=[];for(let r=0,s=this.rows.length;r<s;r+=1)t[r]=e(this.rows[r],r,n);return t}}async mapAsync(e,t={}){const{inplace:r,thisArg:n=this.rows}=t;if(r){for(let t=0,r=this.rows.length;t<r;t+=1)this.rows[t]=e(this.rows[t],t,n);return this.rows}{const t=[];for(let r=0,s=this.rows.length;r<s;r+=1)t[r]=e(this.rows[r],r,n);return t}}}class MarkdownParser{constructor(e){this.worker=new ExtendedWorker((function(){globalThis.onmessage=function(e){globalThis.postMessage({id:e.data.id,data:{data:marked(e.data.data)}})}}),{promise:!0,importScripts:e||"https://cdn.jsdelivr.net/npm/marked/marked.min.js"})}async parse(e){return(await this.worker.postMessage(e)).data}terminate(){this.worker.terminate()}}class VariableManager{constructor(){const e=getGlobal();if("VariableManager"in e){if(e.VariableManager!==this)throw new Error("You are allowed to instanciate only one VariableManager per page")}else e.VariableManager=this,this.map={};return e.VariableManager}register(e,t){t="object"==typeof t?t:{};const{exec:r,parser:n}=t;if(e in this.map||!r&&!n)return!1;this.map[e]={exec:r,parser:n}}async execute(){const e=[document.body],t=[];for(;e.length>0;){const r=e.shift(),{length:n}=r.childNodes.length;for(let s=0;s<n;s+=1){const n=r.childNodes[s];[1,11].includes(n.nodeType)?e.unshift(n):[3,8].includes(n.nodeType)&&/{{(.|\n|\r)*}}/g.test(n.textContent)&&t.push(n.parentNode)}}for(const e of t){let t=e.innerHTML;ObjectForEach(this.map,((r,n)=>{const s=new RegExp(`{{${r}:?(.|\n|\r)*?}}`,"g").exec(t);if(s&&s.length>0){const o=s.filter((e=>e)),{parser:i,exec:a}=n;for(const n of o){e.innerHTML="",t=t.split(n);for(let s=0;s<t.length;s++){const o=document.createTextNode(t[s]);if(e.appendChild(o),s<t.length-1){const t=a(VariableManager.parse(r,i,n));e.appendChild(t)||e.insertAdjacentElement("afterend",t)}}}}}))}}static parse(e,t,r){if(r.length<4+e.length+1+3)return{};return r.slice(2+e.length+1,r.length-2).split(/;/g).reduce(((e,r)=>{const[n,s]=r.split(/=/);if(n in t)if("number"===t[n])try{e[n]=Number(s)}catch(e){console.error(e)}else if("symbol"===t[n])try{e[n]=Symbol(s)}catch(e){console.error(e)}else if("string"===t[n])e[n]=s.toString();else if("boolean"===t[n])try{e[n]=Boolean(s)}catch(e){console.error(e)}return e}),{})}static execute(){const e=getGlobal();if(!("VariableManager"in e))throw new Error("VariableManager was not instanciated.");return e.VariableManager.execute()}}